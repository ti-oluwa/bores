<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="3D Three-Phase Black-Oil Reservoir Modelling and Simulation Framework in Python"><meta name=author content=ti-oluwa><link href=https://ti-oluwa.github.io/bores/user-guide/capillary-pressure/ rel=canonical><link href=../relative-permeability/ rel=prev><link href=../wells/basics/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.3"><title>Capillary Pressure - BORES</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=DM+Sans:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"DM Sans";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=amber> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#capillary-pressure class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=BORES class="md-header__button md-logo" aria-label=BORES data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> BORES </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Capillary Pressure </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=amber aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=amber aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=teal data-md-color-accent=amber aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/ti-oluwa/bores title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> ti-oluwa/bores </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../getting-started/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../../fundamentals/ class=md-tabs__link> Fundamentals </a> </li> <li class=md-tabs__item> <a href=../../tutorials/ class=md-tabs__link> Tutorials </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> User Guide </a> </li> <li class=md-tabs__item> <a href=../../visualization/ class=md-tabs__link> Visualization </a> </li> <li class=md-tabs__item> <a href=../../api-reference/ class=md-tabs__link> API Reference </a> </li> <li class=md-tabs__item> <a href=../../best-practices/ class=md-tabs__link> Best Practices </a> </li> <li class=md-tabs__item> <a href=../../examples/ class=md-tabs__link> Examples </a> </li> <li class=md-tabs__item> <a href=../../reference/glossary/ class=md-tabs__link> Reference </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=BORES class="md-nav__button md-logo" aria-label=BORES data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> BORES </label> <div class=md-nav__source> <a href=https://github.com/ti-oluwa/bores title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> ti-oluwa/bores </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <div class="md-nav__link md-nav__container"> <a href=../../getting-started/ class="md-nav__link "> <span class=md-ellipsis> Getting Started </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../getting-started/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/quickstart/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/concepts/ class=md-nav__link> <span class=md-ellipsis> Core Concepts </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../../fundamentals/ class="md-nav__link "> <span class=md-ellipsis> Fundamentals </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Fundamentals </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../fundamentals/reservoir-simulation/ class=md-nav__link> <span class=md-ellipsis> Reservoir Simulation </span> </a> </li> <li class=md-nav__item> <a href=../../fundamentals/black-oil-model/ class=md-nav__link> <span class=md-ellipsis> The Black-Oil Model </span> </a> </li> <li class=md-nav__item> <a href=../../fundamentals/grid-systems/ class=md-nav__link> <span class=md-ellipsis> Grid Systems </span> </a> </li> <li class=md-nav__item> <a href=../../fundamentals/simulation-workflow/ class=md-nav__link> <span class=md-ellipsis> Simulation Workflow </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../../tutorials/ class="md-nav__link "> <span class=md-ellipsis> Tutorials </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tutorials/01-first-simulation/ class=md-nav__link> <span class=md-ellipsis> 1. Your First Simulation </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/02-building-models/ class=md-nav__link> <span class=md-ellipsis> 2. Building Reservoir Models </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/03-waterflood/ class=md-nav__link> <span class=md-ellipsis> 3. Waterflood Simulation </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/04-gas-injection/ class=md-nav__link> <span class=md-ellipsis> 4. Gas Injection </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/05-miscible-flooding/ class=md-nav__link> <span class=md-ellipsis> 5. Miscible Gas Flooding </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> User Guide </span> </a> <label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=true> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../grids/ class=md-nav__link> <span class=md-ellipsis> Grids </span> </a> </li> <li class=md-nav__item> <a href=../rock-properties/ class=md-nav__link> <span class=md-ellipsis> Rock Properties </span> </a> </li> <li class=md-nav__item> <a href=../fluid-properties/ class=md-nav__link> <span class=md-ellipsis> Fluid Properties </span> </a> </li> <li class=md-nav__item> <a href=../relative-permeability/ class=md-nav__link> <span class=md-ellipsis> Relative Permeability </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Capillary Pressure </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Capillary Pressure </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#what-is-capillary-pressure class=md-nav__link> <span class=md-ellipsis> What is Capillary Pressure? </span> </a> </li> <li class=md-nav__item> <a href=#the-brooks-corey-model class=md-nav__link> <span class=md-ellipsis> The Brooks-Corey Model </span> </a> <nav class=md-nav aria-label="The Brooks-Corey Model"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#basic-usage class=md-nav__link> <span class=md-ellipsis> Basic Usage </span> </a> </li> <li class=md-nav__item> <a href=#brooks-corey-parameters class=md-nav__link> <span class=md-ellipsis> Brooks-Corey Parameters </span> </a> </li> <li class=md-nav__item> <a href=#wettability-effects-on-capillary-pressure class=md-nav__link> <span class=md-ellipsis> Wettability Effects on Capillary Pressure </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#the-van-genuchten-model class=md-nav__link> <span class=md-ellipsis> The Van Genuchten Model </span> </a> <nav class=md-nav aria-label="The Van Genuchten Model"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#van-genuchten-usage class=md-nav__link> <span class=md-ellipsis> Van Genuchten Usage </span> </a> </li> <li class=md-nav__item> <a href=#van-genuchten-parameters class=md-nav__link> <span class=md-ellipsis> Van Genuchten Parameters </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#the-leverett-j-function-model class=md-nav__link> <span class=md-ellipsis> The Leverett J-Function Model </span> </a> <nav class=md-nav aria-label="The Leverett J-Function Model"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#leverett-j-function-usage class=md-nav__link> <span class=md-ellipsis> Leverett J-Function Usage </span> </a> </li> <li class=md-nav__item> <a href=#leverett-j-function-parameters class=md-nav__link> <span class=md-ellipsis> Leverett J-Function Parameters </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#tabular-capillary-pressure class=md-nav__link> <span class=md-ellipsis> Tabular Capillary Pressure </span> </a> <nav class=md-nav aria-label="Tabular Capillary Pressure"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#twophasecapillarypressuretable class=md-nav__link> <span class=md-ellipsis> TwoPhaseCapillaryPressureTable </span> </a> </li> <li class=md-nav__item> <a href=#threephasecapillarypressuretable class=md-nav__link> <span class=md-ellipsis> ThreePhaseCapillaryPressureTable </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#direct-usage-outside-simulation class=md-nav__link> <span class=md-ellipsis> Direct Usage (Outside Simulation) </span> </a> <nav class=md-nav aria-label="Direct Usage (Outside Simulation)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#calling-analytical-models-directly class=md-nav__link> <span class=md-ellipsis> Calling Analytical Models Directly </span> </a> </li> <li class=md-nav__item> <a href=#calling-tabular-models-directly class=md-nav__link> <span class=md-ellipsis> Calling Tabular Models Directly </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#integrating-with-rockfluidtables class=md-nav__link> <span class=md-ellipsis> Integrating with RockFluidTables </span> </a> </li> <li class=md-nav__item> <a href=#visualizing-capillary-pressure-curves class=md-nav__link> <span class=md-ellipsis> Visualizing Capillary Pressure Curves </span> </a> <nav class=md-nav aria-label="Visualizing Capillary Pressure Curves"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#oil-water-capillary-pressure class=md-nav__link> <span class=md-ellipsis> Oil-Water Capillary Pressure </span> </a> </li> <li class=md-nav__item> <a href=#comparing-models class=md-nav__link> <span class=md-ellipsis> Comparing Models </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#choosing-a-capillary-pressure-model class=md-nav__link> <span class=md-ellipsis> Choosing a Capillary Pressure Model </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_7> <label class=md-nav__link for=__nav_5_7 id=__nav_5_7_label tabindex> <span class=md-ellipsis> Wells </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_7_label aria-expanded=false> <label class=md-nav__title for=__nav_5_7> <span class="md-nav__icon md-icon"></span> Wells </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../wells/basics/ class=md-nav__link> <span class=md-ellipsis> Well Basics </span> </a> </li> <li class=md-nav__item> <a href=../wells/controls/ class=md-nav__link> <span class=md-ellipsis> Well Controls </span> </a> </li> <li class=md-nav__item> <a href=../wells/fluids/ class=md-nav__link> <span class=md-ellipsis> Well Fluids </span> </a> </li> <li class=md-nav__item> <a href=../wells/schedules/ class=md-nav__link> <span class=md-ellipsis> Well Schedules </span> </a> </li> <li class=md-nav__item> <a href=../wells/patterns/ class=md-nav__link> <span class=md-ellipsis> Well Patterns </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_8> <label class=md-nav__link for=__nav_5_8 id=__nav_5_8_label tabindex> <span class=md-ellipsis> Simulation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_8_label aria-expanded=false> <label class=md-nav__title for=__nav_5_8> <span class="md-nav__icon md-icon"></span> Simulation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../simulation/schemes/ class=md-nav__link> <span class=md-ellipsis> Schemes </span> </a> </li> <li class=md-nav__item> <a href=../simulation/solvers/ class=md-nav__link> <span class=md-ellipsis> Solvers </span> </a> </li> <li class=md-nav__item> <a href=../simulation/preconditioners/ class=md-nav__link> <span class=md-ellipsis> Preconditioners </span> </a> </li> <li class=md-nav__item> <a href=../simulation/timestep-control/ class=md-nav__link> <span class=md-ellipsis> Timestep Control </span> </a> </li> <li class=md-nav__item> <a href=../simulation/precision/ class=md-nav__link> <span class=md-ellipsis> Precision </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_9> <label class=md-nav__link for=__nav_5_9 id=__nav_5_9_label tabindex> <span class=md-ellipsis> Advanced </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_9_label aria-expanded=false> <label class=md-nav__title for=__nav_5_9> <span class="md-nav__icon md-icon"></span> Advanced </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../advanced/pvt-tables/ class=md-nav__link> <span class=md-ellipsis> PVT Tables </span> </a> </li> <li class=md-nav__item> <a href=../advanced/fractures/ class=md-nav__link> <span class=md-ellipsis> Faults & Fractures </span> </a> </li> <li class=md-nav__item> <a href=../advanced/miscibility/ class=md-nav__link> <span class=md-ellipsis> Miscible Flooding </span> </a> </li> <li class=md-nav__item> <a href=../advanced/boundary-conditions/ class=md-nav__link> <span class=md-ellipsis> Boundary Conditions </span> </a> </li> <li class=md-nav__item> <a href=../advanced/aquifers/ class=md-nav__link> <span class=md-ellipsis> Aquifer Modeling </span> </a> </li> <li class=md-nav__item> <a href=../advanced/states-streams/ class=md-nav__link> <span class=md-ellipsis> States & Streams </span> </a> </li> <li class=md-nav__item> <a href=../advanced/model-analysis/ class=md-nav__link> <span class=md-ellipsis> Model Analysis </span> </a> </li> <li class=md-nav__item> <a href=../advanced/serialization/ class=md-nav__link> <span class=md-ellipsis> Serialization </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../config/ class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=../constants/ class=md-nav__link> <span class=md-ellipsis> Constants </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <div class="md-nav__link md-nav__container"> <a href=../../visualization/ class="md-nav__link "> <span class=md-ellipsis> Visualization </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Visualization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../visualization/1d-plots/ class=md-nav__link> <span class=md-ellipsis> 1D Time Series </span> </a> </li> <li class=md-nav__item> <a href=../../visualization/2d-maps/ class=md-nav__link> <span class=md-ellipsis> 2D Maps </span> </a> </li> <li class=md-nav__item> <a href=../../visualization/3d-rendering/ class=md-nav__link> <span class=md-ellipsis> 3D Volume Rendering </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <div class="md-nav__link md-nav__container"> <a href=../../api-reference/ class="md-nav__link "> <span class=md-ellipsis> API Reference </span> </a> <label class="md-nav__link " for=__nav_7 id=__nav_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api-reference/correlations-scalar/ class=md-nav__link> <span class=md-ellipsis> Scalar Correlations </span> </a> </li> <li class=md-nav__item> <a href=../../api-reference/correlations-array/ class=md-nav__link> <span class=md-ellipsis> Array Correlations </span> </a> </li> <li class=md-nav__item> <a href=../../api-reference/full-api/ class=md-nav__link> <span class=md-ellipsis> Full API </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <div class="md-nav__link md-nav__container"> <a href=../../best-practices/ class="md-nav__link "> <span class=md-ellipsis> Best Practices </span> </a> <label class="md-nav__link " for=__nav_8 id=__nav_8_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Best Practices </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../best-practices/grid-design/ class=md-nav__link> <span class=md-ellipsis> Grid Design </span> </a> </li> <li class=md-nav__item> <a href=../../best-practices/timestep-selection/ class=md-nav__link> <span class=md-ellipsis> Timestep Selection </span> </a> </li> <li class=md-nav__item> <a href=../../best-practices/solver-selection/ class=md-nav__link> <span class=md-ellipsis> Solver Selection </span> </a> </li> <li class=md-nav__item> <a href=../../best-practices/errors/ class=md-nav__link> <span class=md-ellipsis> Errors </span> </a> </li> <li class=md-nav__item> <a href=../../best-practices/performance/ class=md-nav__link> <span class=md-ellipsis> Performance </span> </a> </li> <li class=md-nav__item> <a href=../../best-practices/validation/ class=md-nav__link> <span class=md-ellipsis> Validation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_9> <div class="md-nav__link md-nav__container"> <a href=../../examples/ class="md-nav__link "> <span class=md-ellipsis> Examples </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_10> <label class=md-nav__link for=__nav_10 id=__nav_10_label tabindex=0> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_10_label aria-expanded=false> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/glossary/ class=md-nav__link> <span class=md-ellipsis> Glossary </span> </a> </li> <li class=md-nav__item> <a href=../../reference/units/ class=md-nav__link> <span class=md-ellipsis> Units </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#what-is-capillary-pressure class=md-nav__link> <span class=md-ellipsis> What is Capillary Pressure? </span> </a> </li> <li class=md-nav__item> <a href=#the-brooks-corey-model class=md-nav__link> <span class=md-ellipsis> The Brooks-Corey Model </span> </a> <nav class=md-nav aria-label="The Brooks-Corey Model"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#basic-usage class=md-nav__link> <span class=md-ellipsis> Basic Usage </span> </a> </li> <li class=md-nav__item> <a href=#brooks-corey-parameters class=md-nav__link> <span class=md-ellipsis> Brooks-Corey Parameters </span> </a> </li> <li class=md-nav__item> <a href=#wettability-effects-on-capillary-pressure class=md-nav__link> <span class=md-ellipsis> Wettability Effects on Capillary Pressure </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#the-van-genuchten-model class=md-nav__link> <span class=md-ellipsis> The Van Genuchten Model </span> </a> <nav class=md-nav aria-label="The Van Genuchten Model"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#van-genuchten-usage class=md-nav__link> <span class=md-ellipsis> Van Genuchten Usage </span> </a> </li> <li class=md-nav__item> <a href=#van-genuchten-parameters class=md-nav__link> <span class=md-ellipsis> Van Genuchten Parameters </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#the-leverett-j-function-model class=md-nav__link> <span class=md-ellipsis> The Leverett J-Function Model </span> </a> <nav class=md-nav aria-label="The Leverett J-Function Model"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#leverett-j-function-usage class=md-nav__link> <span class=md-ellipsis> Leverett J-Function Usage </span> </a> </li> <li class=md-nav__item> <a href=#leverett-j-function-parameters class=md-nav__link> <span class=md-ellipsis> Leverett J-Function Parameters </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#tabular-capillary-pressure class=md-nav__link> <span class=md-ellipsis> Tabular Capillary Pressure </span> </a> <nav class=md-nav aria-label="Tabular Capillary Pressure"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#twophasecapillarypressuretable class=md-nav__link> <span class=md-ellipsis> TwoPhaseCapillaryPressureTable </span> </a> </li> <li class=md-nav__item> <a href=#threephasecapillarypressuretable class=md-nav__link> <span class=md-ellipsis> ThreePhaseCapillaryPressureTable </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#direct-usage-outside-simulation class=md-nav__link> <span class=md-ellipsis> Direct Usage (Outside Simulation) </span> </a> <nav class=md-nav aria-label="Direct Usage (Outside Simulation)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#calling-analytical-models-directly class=md-nav__link> <span class=md-ellipsis> Calling Analytical Models Directly </span> </a> </li> <li class=md-nav__item> <a href=#calling-tabular-models-directly class=md-nav__link> <span class=md-ellipsis> Calling Tabular Models Directly </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#integrating-with-rockfluidtables class=md-nav__link> <span class=md-ellipsis> Integrating with RockFluidTables </span> </a> </li> <li class=md-nav__item> <a href=#visualizing-capillary-pressure-curves class=md-nav__link> <span class=md-ellipsis> Visualizing Capillary Pressure Curves </span> </a> <nav class=md-nav aria-label="Visualizing Capillary Pressure Curves"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#oil-water-capillary-pressure class=md-nav__link> <span class=md-ellipsis> Oil-Water Capillary Pressure </span> </a> </li> <li class=md-nav__item> <a href=#comparing-models class=md-nav__link> <span class=md-ellipsis> Comparing Models </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#choosing-a-capillary-pressure-model class=md-nav__link> <span class=md-ellipsis> Choosing a Capillary Pressure Model </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <nav class=md-path aria-label=Navigation> <ol class=md-path__list> <li class=md-path__item> <a href=../.. class=md-path__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-path__item> <a href=../ class=md-path__link> <span class=md-ellipsis> User Guide </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <a href=https://github.com/ti-oluwa/bores/edit/main/docs/user-guide/capillary-pressure.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg> </a> <a href=https://github.com/ti-oluwa/bores/raw/main/docs/user-guide/capillary-pressure.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"/></svg> </a> <h1 id=capillary-pressure>Capillary Pressure<a class=headerlink href=#capillary-pressure title="Permanent link">&para;</a></h1> <h2 id=what-is-capillary-pressure>What is Capillary Pressure?<a class=headerlink href=#what-is-capillary-pressure title="Permanent link">&para;</a></h2> <p>When two immiscible fluids share the same pore space, the interface between them curves due to differences in how strongly each fluid adheres to the rock surface. This curvature creates a pressure difference across the fluid-fluid interface, and that pressure difference is called capillary pressure. It is defined as the pressure in the non-wetting phase minus the pressure in the wetting phase:</p> <div class=arithmatex>\[P_c = P_{nw} - P_w\]</div> <p>In a water-wet rock, water preferentially coats the grain surfaces and occupies the smaller pores, making water the wetting phase and oil the non-wetting phase. The oil-water capillary pressure <span class=arithmatex>\(P_{cow} = P_o - P_w\)</span> is positive, meaning oil pressure exceeds water pressure. This pressure difference is what allows oil to occupy larger pores while water fills the smaller ones. The magnitude of capillary pressure depends on the pore throat size, the interfacial tension between the fluids, the contact angle of the fluid-rock system, and the saturation state.</p> <p>Capillary pressure plays a critical role in controlling the initial fluid distribution in a reservoir. Before any production begins, the reservoir is in capillary-gravity equilibrium: the capillary pressure at every point balances the gravity head caused by the density difference between the fluids. This equilibrium determines the transition zone, the region between the free water level and the depth where oil saturation reaches its maximum. In thick transition zones (common in tight rocks with high capillary pressure), water saturation decreases gradually with height above the free water level, and the oil column is never fully "clean" of water. In high-permeability rocks with low capillary pressure, the transition zone is thin and the contacts are sharp.</p> <p>During simulation, capillary pressure affects flow by modifying the pressure field. The pressure equation for each phase includes a capillary pressure correction: <span class=arithmatex>\(P_o = P_w + P_{cow}\)</span> and <span class=arithmatex>\(P_g = P_o + P_{cgo}\)</span>. This means capillary forces act as an additional driving force (or resistance) to flow. In waterflooding, capillary pressure causes imbibition, where water spontaneously enters oil-filled pores even without an external pressure gradient. In gas injection, capillary entry pressure can prevent gas from entering tight rock layers, creating capillary barriers that trap gas.</p> <p>In a three-phase system (oil, water, gas), BORES tracks two capillary pressures:</p> <ul> <li><strong>Oil-water capillary pressure</strong>: <span class=arithmatex>\(P_{cow} = P_o - P_w\)</span> (positive in water-wet rock)</li> <li><strong>Gas-oil capillary pressure</strong>: <span class=arithmatex>\(P_{cgo} = P_g - P_o\)</span> (positive because gas is always non-wetting relative to oil)</li> </ul> <p>Both depend on saturation and are computed by the capillary pressure model at every grid cell and every timestep.</p> <hr> <h2 id=the-brooks-corey-model>The Brooks-Corey Model<a class=headerlink href=#the-brooks-corey-model title="Permanent link">&para;</a></h2> <p>The Brooks-Corey capillary pressure model is the most widely used analytical correlation in petroleum engineering. It relates capillary pressure to the effective saturation through a power law based on two parameters: the entry pressure and the pore size distribution index.</p> <p>The model is expressed as:</p> <div class=arithmatex>\[P_c = P_d \cdot S_e^{-1/\lambda}\]</div> <p>where <span class=arithmatex>\(P_d\)</span> is the entry (or displacement) pressure in psi, <span class=arithmatex>\(S_e\)</span> is the effective (normalized) saturation, and <span class=arithmatex>\(\lambda\)</span> is the pore size distribution index. The entry pressure <span class=arithmatex>\(P_d\)</span> represents the minimum capillary pressure needed for the non-wetting phase to enter the largest pore throats. Rocks with large, well-connected pores have low entry pressures (1-5 psi), while tight rocks with small pore throats have high entry pressures (10-50+ psi).</p> <p>The pore size distribution index <span class=arithmatex>\(\lambda\)</span> controls how rapidly capillary pressure changes with saturation. A large <span class=arithmatex>\(\lambda\)</span> (say 4-6) means the pore sizes are narrowly distributed (uniform rock), so capillary pressure changes gradually and the transition zone is narrow. A small <span class=arithmatex>\(\lambda\)</span> (say 0.5-1.5) means the pore sizes vary widely, producing a broad transition zone where capillary pressure changes steeply near residual saturation. Most reservoir sandstones have <span class=arithmatex>\(\lambda\)</span> values between 1.5 and 4.0, while carbonates tend to have lower values due to their more heterogeneous pore structure.</p> <h3 id=basic-usage>Basic Usage<a class=headerlink href=#basic-usage title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kn>import</span><span class=w> </span><span class=nn>bores</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=n>capillary</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>BrooksCoreyCapillaryPressureModel</span><span class=p>(</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>    <span class=n>oil_water_entry_pressure_water_wet</span><span class=o>=</span><span class=mf>5.0</span><span class=p>,</span>     <span class=c1># psi</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>    <span class=n>oil_water_pore_size_distribution_index_water_wet</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>    <span class=n>gas_oil_entry_pressure</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span>                  <span class=c1># psi</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>    <span class=n>gas_oil_pore_size_distribution_index</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=p>)</span>
</span></code></pre></div> <p>This creates a water-wet Brooks-Corey model with an oil-water entry pressure of 5 psi, a gas-oil entry pressure of 1 psi, and a pore size distribution index of 2.0 for both systems. The gas-oil entry pressure is typically lower than the oil-water entry pressure because the gas-oil interfacial tension is lower than oil-water interfacial tension.</p> <p>Like the relative permeability model, residual saturations can be set on the model or inherited from the reservoir model. When the saturation endpoints are set to <code>None</code> (the default), BORES uses the endpoint grids from the reservoir model automatically. If you provide explicit values, those override the grid-level defaults.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=n>capillary</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>BrooksCoreyCapillaryPressureModel</span><span class=p>(</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>    <span class=n>irreducible_water_saturation</span><span class=o>=</span><span class=mf>0.25</span><span class=p>,</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>    <span class=n>residual_oil_saturation_water</span><span class=o>=</span><span class=mf>0.25</span><span class=p>,</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>    <span class=n>residual_oil_saturation_gas</span><span class=o>=</span><span class=mf>0.15</span><span class=p>,</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>    <span class=n>residual_gas_saturation</span><span class=o>=</span><span class=mf>0.05</span><span class=p>,</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>    <span class=n>oil_water_entry_pressure_water_wet</span><span class=o>=</span><span class=mf>5.0</span><span class=p>,</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>    <span class=n>oil_water_pore_size_distribution_index_water_wet</span><span class=o>=</span><span class=mf>2.5</span><span class=p>,</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>    <span class=n>gas_oil_entry_pressure</span><span class=o>=</span><span class=mf>1.5</span><span class=p>,</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>    <span class=n>gas_oil_pore_size_distribution_index</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=p>)</span>
</span></code></pre></div> <h3 id=brooks-corey-parameters>Brooks-Corey Parameters<a class=headerlink href=#brooks-corey-parameters title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Parameter</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>irreducible_water_saturation</code></td> <td><code>None</code></td> <td>Connate water saturation <span class=arithmatex>\(S_{wc}\)</span>. If <code>None</code>, uses grid values.</td> </tr> <tr> <td><code>residual_oil_saturation_water</code></td> <td><code>None</code></td> <td>Residual oil to waterflood <span class=arithmatex>\(S_{or,w}\)</span>. If <code>None</code>, uses grid values.</td> </tr> <tr> <td><code>residual_oil_saturation_gas</code></td> <td><code>None</code></td> <td>Residual oil to gas flood <span class=arithmatex>\(S_{or,g}\)</span>. If <code>None</code>, uses grid values.</td> </tr> <tr> <td><code>residual_gas_saturation</code></td> <td><code>None</code></td> <td>Trapped gas saturation <span class=arithmatex>\(S_{gr}\)</span>. If <code>None</code>, uses grid values.</td> </tr> <tr> <td><code>oil_water_entry_pressure_water_wet</code></td> <td><code>5.0</code></td> <td>Entry pressure for oil-water system, water-wet (psi)</td> </tr> <tr> <td><code>oil_water_entry_pressure_oil_wet</code></td> <td><code>5.0</code></td> <td>Entry pressure for oil-water system, oil-wet (psi)</td> </tr> <tr> <td><code>oil_water_pore_size_distribution_index_water_wet</code></td> <td><code>2.0</code></td> <td>Pore size distribution index <span class=arithmatex>\(\lambda\)</span> for oil-water, water-wet</td> </tr> <tr> <td><code>oil_water_pore_size_distribution_index_oil_wet</code></td> <td><code>2.0</code></td> <td>Pore size distribution index <span class=arithmatex>\(\lambda\)</span> for oil-water, oil-wet</td> </tr> <tr> <td><code>gas_oil_entry_pressure</code></td> <td><code>1.0</code></td> <td>Entry pressure for gas-oil system (psi)</td> </tr> <tr> <td><code>gas_oil_pore_size_distribution_index</code></td> <td><code>2.0</code></td> <td>Pore size distribution index <span class=arithmatex>\(\lambda\)</span> for gas-oil</td> </tr> <tr> <td><code>wettability</code></td> <td><code>WATER_WET</code></td> <td>Rock wettability (<code>WATER_WET</code>, <code>OIL_WET</code>, or <code>MIXED_WET</code>)</td> </tr> <tr> <td><code>mixed_wet_water_fraction</code></td> <td><code>0.5</code></td> <td>Fraction of pore space that is water-wet (for <code>MIXED_WET</code> only)</td> </tr> </tbody> </table> <h3 id=wettability-effects-on-capillary-pressure>Wettability Effects on Capillary Pressure<a class=headerlink href=#wettability-effects-on-capillary-pressure title="Permanent link">&para;</a></h3> <p>Wettability fundamentally changes the sign and magnitude of capillary pressure. In a water-wet system, oil must overcome the capillary entry pressure to enter a pore, so <span class=arithmatex>\(P_{cow} &gt; 0\)</span>. In an oil-wet system, the rock surface prefers oil, and water must overcome an entry pressure to displace oil, so <span class=arithmatex>\(P_{cow} &lt; 0\)</span>. In a mixed-wet system, BORES computes a weighted average of the water-wet and oil-wet capillary pressures.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=kn>import</span><span class=w> </span><span class=nn>bores</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=c1># Water-wet system: positive Pcow</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=n>cap_ww</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>BrooksCoreyCapillaryPressureModel</span><span class=p>(</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>    <span class=n>oil_water_entry_pressure_water_wet</span><span class=o>=</span><span class=mf>5.0</span><span class=p>,</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>    <span class=n>oil_water_pore_size_distribution_index_water_wet</span><span class=o>=</span><span class=mf>2.5</span><span class=p>,</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>    <span class=n>gas_oil_entry_pressure</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>    <span class=n>gas_oil_pore_size_distribution_index</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>    <span class=n>wettability</span><span class=o>=</span><span class=n>bores</span><span class=o>.</span><span class=n>Wettability</span><span class=o>.</span><span class=n>WATER_WET</span><span class=p>,</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=p>)</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=c1># Oil-wet system: negative Pcow</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=n>cap_ow</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>BrooksCoreyCapillaryPressureModel</span><span class=p>(</span>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a>    <span class=n>oil_water_entry_pressure_oil_wet</span><span class=o>=</span><span class=mf>4.0</span><span class=p>,</span>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a>    <span class=n>oil_water_pore_size_distribution_index_oil_wet</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>    <span class=n>gas_oil_entry_pressure</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span>
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a>    <span class=n>gas_oil_pore_size_distribution_index</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a>    <span class=n>wettability</span><span class=o>=</span><span class=n>bores</span><span class=o>.</span><span class=n>Wettability</span><span class=o>.</span><span class=n>OIL_WET</span><span class=p>,</span>
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=p>)</span>
</span><span id=__span-2-20><a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a>
</span><span id=__span-2-21><a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=c1># Mixed-wet system: 60% water-wet, 40% oil-wet pore surfaces</span>
</span><span id=__span-2-22><a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=n>cap_mw</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>BrooksCoreyCapillaryPressureModel</span><span class=p>(</span>
</span><span id=__span-2-23><a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a>    <span class=n>oil_water_entry_pressure_water_wet</span><span class=o>=</span><span class=mf>5.0</span><span class=p>,</span>
</span><span id=__span-2-24><a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a>    <span class=n>oil_water_entry_pressure_oil_wet</span><span class=o>=</span><span class=mf>4.0</span><span class=p>,</span>
</span><span id=__span-2-25><a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a>    <span class=n>oil_water_pore_size_distribution_index_water_wet</span><span class=o>=</span><span class=mf>2.5</span><span class=p>,</span>
</span><span id=__span-2-26><a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a>    <span class=n>oil_water_pore_size_distribution_index_oil_wet</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-2-27><a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a>    <span class=n>gas_oil_entry_pressure</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span>
</span><span id=__span-2-28><a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a>    <span class=n>gas_oil_pore_size_distribution_index</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-2-29><a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a>    <span class=n>wettability</span><span class=o>=</span><span class=n>bores</span><span class=o>.</span><span class=n>Wettability</span><span class=o>.</span><span class=n>MIXED_WET</span><span class=p>,</span>
</span><span id=__span-2-30><a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a>    <span class=n>mixed_wet_water_fraction</span><span class=o>=</span><span class=mf>0.6</span><span class=p>,</span>
</span><span id=__span-2-31><a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a><span class=p>)</span>
</span></code></pre></div> <p>The mixed-wet option is particularly useful for carbonate reservoirs and aged sandstones where the wettability is intermediate. The <code>mixed_wet_water_fraction</code> parameter controls the weighting: a value of 0.6 means 60% of the pore surface area is water-wet and 40% is oil-wet. The resulting capillary pressure is a linear combination of the two end-member curves, which can produce the characteristic "crossover" behavior seen in mixed-wet SCAL data where capillary pressure changes sign at intermediate saturations.</p> <div class="admonition info"> <p class=admonition-title>Entry Pressure and Rock Quality</p> <p>Entry pressure correlates inversely with permeability. High-permeability sands (500+ mD) may have entry pressures below 1 psi, while tight sandstones (1-10 mD) can have entry pressures of 20-50 psi. A useful rule of thumb: <span class=arithmatex>\(P_d \approx C / \sqrt{k}\)</span> where <span class=arithmatex>\(C\)</span> is an empirical constant (roughly 3-10 depending on the rock type) and <span class=arithmatex>\(k\)</span> is permeability in mD.</p> </div> <hr> <h2 id=the-van-genuchten-model>The Van Genuchten Model<a class=headerlink href=#the-van-genuchten-model title="Permanent link">&para;</a></h2> <p>The Van Genuchten model is an alternative to Brooks-Corey that provides smoother capillary pressure curves, particularly near the residual saturations where Brooks-Corey produces infinite values. This smoothness makes the Van Genuchten model numerically better-behaved and is often preferred for simulations where convergence near residual saturation is important.</p> <p>The model is expressed as:</p> <div class=arithmatex>\[P_c = \frac{1}{\alpha} \left[ S_e^{-1/m} - 1 \right]^{1/n}\]</div> <p>where <span class=arithmatex>\(\alpha\)</span> is an inverse pressure parameter (in 1/psi), <span class=arithmatex>\(n\)</span> is a shape parameter that must be greater than 1, and <span class=arithmatex>\(m = 1 - 1/n\)</span> is derived from <span class=arithmatex>\(n\)</span>. The parameter <span class=arithmatex>\(\alpha\)</span> is roughly the inverse of the entry pressure: larger <span class=arithmatex>\(\alpha\)</span> values produce lower capillary pressures. The parameter <span class=arithmatex>\(n\)</span> controls the curve shape and has a similar role to the pore size distribution index in Brooks-Corey: higher values produce narrower transition zones.</p> <p>The key advantage of Van Genuchten over Brooks-Corey is its behavior at the endpoints. Brooks-Corey capillary pressure goes to infinity as saturation approaches the residual value (<span class=arithmatex>\(S_e \to 0\)</span>), which can cause numerical difficulties. Van Genuchten also approaches infinity but does so more gradually, which makes the transition smoother and reduces the risk of solver convergence issues.</p> <h3 id=van-genuchten-usage>Van Genuchten Usage<a class=headerlink href=#van-genuchten-usage title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=kn>import</span><span class=w> </span><span class=nn>bores</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=n>capillary</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>VanGenuchtenCapillaryPressureModel</span><span class=p>(</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>    <span class=n>oil_water_alpha_water_wet</span><span class=o>=</span><span class=mf>0.01</span><span class=p>,</span>    <span class=c1># 1/psi (roughly: entry pressure ~ 1/alpha)</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>    <span class=n>oil_water_n_water_wet</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>          <span class=c1># Shape parameter (must be &gt; 1)</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>    <span class=n>gas_oil_alpha</span><span class=o>=</span><span class=mf>0.02</span><span class=p>,</span>                 <span class=c1># 1/psi</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>    <span class=n>gas_oil_n</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>                      <span class=c1># Shape parameter</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=p>)</span>
</span></code></pre></div> <p>The Van Genuchten model supports the same wettability options as Brooks-Corey, with separate parameters for the water-wet and oil-wet components. For water-wet systems, <span class=arithmatex>\(P_{cow} &gt; 0\)</span>; for oil-wet, <span class=arithmatex>\(P_{cow} &lt; 0\)</span>; and for mixed-wet, a weighted average is used.</p> <h3 id=van-genuchten-parameters>Van Genuchten Parameters<a class=headerlink href=#van-genuchten-parameters title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Parameter</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>irreducible_water_saturation</code></td> <td><code>None</code></td> <td>Connate water saturation <span class=arithmatex>\(S_{wc}\)</span>.</td> </tr> <tr> <td><code>residual_oil_saturation_water</code></td> <td><code>None</code></td> <td>Residual oil to waterflood <span class=arithmatex>\(S_{or,w}\)</span>.</td> </tr> <tr> <td><code>residual_oil_saturation_gas</code></td> <td><code>None</code></td> <td>Residual oil to gas flood <span class=arithmatex>\(S_{or,g}\)</span>.</td> </tr> <tr> <td><code>residual_gas_saturation</code></td> <td><code>None</code></td> <td>Trapped gas saturation <span class=arithmatex>\(S_{gr}\)</span>.</td> </tr> <tr> <td><code>oil_water_alpha_water_wet</code></td> <td><code>0.01</code></td> <td>Van Genuchten <span class=arithmatex>\(\alpha\)</span> for oil-water, water-wet (1/psi)</td> </tr> <tr> <td><code>oil_water_alpha_oil_wet</code></td> <td><code>0.01</code></td> <td>Van Genuchten <span class=arithmatex>\(\alpha\)</span> for oil-water, oil-wet (1/psi)</td> </tr> <tr> <td><code>oil_water_n_water_wet</code></td> <td><code>2.0</code></td> <td>Van Genuchten <span class=arithmatex>\(n\)</span> for oil-water, water-wet</td> </tr> <tr> <td><code>oil_water_n_oil_wet</code></td> <td><code>2.0</code></td> <td>Van Genuchten <span class=arithmatex>\(n\)</span> for oil-water, oil-wet</td> </tr> <tr> <td><code>gas_oil_alpha</code></td> <td><code>0.01</code></td> <td>Van Genuchten <span class=arithmatex>\(\alpha\)</span> for gas-oil (1/psi)</td> </tr> <tr> <td><code>gas_oil_n</code></td> <td><code>2.0</code></td> <td>Van Genuchten <span class=arithmatex>\(n\)</span> for gas-oil</td> </tr> <tr> <td><code>wettability</code></td> <td><code>WATER_WET</code></td> <td>Rock wettability</td> </tr> <tr> <td><code>mixed_wet_water_fraction</code></td> <td><code>0.5</code></td> <td>Water-wet pore fraction (for <code>MIXED_WET</code>)</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Converting Between Brooks-Corey and Van Genuchten</p> <p>There is no exact conversion between the two models, but approximate relationships exist. The Van Genuchten <span class=arithmatex>\(\alpha\)</span> is roughly the inverse of the Brooks-Corey entry pressure: <span class=arithmatex>\(\alpha \approx 1 / P_d\)</span>. The shape parameters are related by <span class=arithmatex>\(n \approx \lambda + 1\)</span> for <span class=arithmatex>\(\lambda &gt; 1\)</span>. These are rough guides for getting a starting point when switching between models.</p> </div> <hr> <h2 id=the-leverett-j-function-model>The Leverett J-Function Model<a class=headerlink href=#the-leverett-j-function-model title="Permanent link">&para;</a></h2> <p>The Leverett J-function is a dimensionless correlation that normalizes capillary pressure by rock and fluid properties. This makes it possible to transfer capillary pressure data measured on one core sample to other parts of the reservoir with different porosity and permeability, without needing separate measurements for each rock type.</p> <p>The J-function relates capillary pressure to rock quality through:</p> <div class=arithmatex>\[P_c = \sigma \cos\theta \sqrt{\frac{\phi}{k}} \cdot J(S_e)\]</div> <p>where <span class=arithmatex>\(\sigma\)</span> is the interfacial tension (dyne/cm), <span class=arithmatex>\(\theta\)</span> is the contact angle (degrees), <span class=arithmatex>\(\phi\)</span> is porosity, <span class=arithmatex>\(k\)</span> is permeability (mD), and <span class=arithmatex>\(J(S_e)\)</span> is the dimensionless J-function evaluated at effective saturation. The <span class=arithmatex>\(\sqrt{\phi/k}\)</span> factor captures the relationship between rock quality and pore throat size: tight rocks (low <span class=arithmatex>\(k\)</span>, low <span class=arithmatex>\(\phi\)</span>) have smaller pores and therefore higher capillary pressures.</p> <p>In BORES, the J-function uses a power-law form: <span class=arithmatex>\(J(S_e) = a \cdot S_e^{-b}\)</span>, where <span class=arithmatex>\(a\)</span> is the <code>j_function_coefficient</code> and <span class=arithmatex>\(b\)</span> is the <code>j_function_exponent</code>. These empirical parameters are typically calibrated by fitting the J-function model to laboratory capillary pressure data from one or more core plugs.</p> <p>The Leverett J-function approach is most valuable in heterogeneous reservoirs where porosity and permeability vary spatially. Because the model scales capillary pressure by the local <span class=arithmatex>\(\sqrt{\phi/k}\)</span>, it automatically produces higher capillary pressures in tight zones and lower values in high-permeability zones, without needing separate capillary pressure curves for each rock type.</p> <h3 id=leverett-j-function-usage>Leverett J-Function Usage<a class=headerlink href=#leverett-j-function-usage title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=kn>import</span><span class=w> </span><span class=nn>bores</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=n>capillary</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>LeverettJCapillaryPressureModel</span><span class=p>(</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>    <span class=n>permeability</span><span class=o>=</span><span class=mf>100.0</span><span class=p>,</span>                 <span class=c1># mD (reference permeability)</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>    <span class=n>porosity</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span>                        <span class=c1># Reference porosity</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>    <span class=n>oil_water_interfacial_tension</span><span class=o>=</span><span class=mf>30.0</span><span class=p>,</span>  <span class=c1># dyne/cm</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>    <span class=n>gas_oil_interfacial_tension</span><span class=o>=</span><span class=mf>20.0</span><span class=p>,</span>    <span class=c1># dyne/cm</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>    <span class=n>contact_angle_oil_water</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>         <span class=c1># degrees (0 = water-wet)</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>    <span class=n>contact_angle_gas_oil</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>           <span class=c1># degrees</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>    <span class=n>j_function_coefficient</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span>          <span class=c1># Empirical coefficient &#39;a&#39;</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>    <span class=n>j_function_exponent</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span>             <span class=c1># Empirical exponent &#39;b&#39;</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=p>)</span>
</span></code></pre></div> <h3 id=leverett-j-function-parameters>Leverett J-Function Parameters<a class=headerlink href=#leverett-j-function-parameters title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Parameter</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>irreducible_water_saturation</code></td> <td><code>None</code></td> <td>Connate water saturation <span class=arithmatex>\(S_{wc}\)</span>.</td> </tr> <tr> <td><code>residual_oil_saturation_water</code></td> <td><code>None</code></td> <td>Residual oil to waterflood <span class=arithmatex>\(S_{or,w}\)</span>.</td> </tr> <tr> <td><code>residual_oil_saturation_gas</code></td> <td><code>None</code></td> <td>Residual oil to gas flood <span class=arithmatex>\(S_{or,g}\)</span>.</td> </tr> <tr> <td><code>residual_gas_saturation</code></td> <td><code>None</code></td> <td>Trapped gas saturation <span class=arithmatex>\(S_{gr}\)</span>.</td> </tr> <tr> <td><code>permeability</code></td> <td><code>100.0</code></td> <td>Absolute permeability (mD)</td> </tr> <tr> <td><code>porosity</code></td> <td><code>0.2</code></td> <td>Porosity (fraction)</td> </tr> <tr> <td><code>oil_water_interfacial_tension</code></td> <td><code>30.0</code></td> <td>Oil-water IFT (dyne/cm)</td> </tr> <tr> <td><code>gas_oil_interfacial_tension</code></td> <td><code>20.0</code></td> <td>Gas-oil IFT (dyne/cm)</td> </tr> <tr> <td><code>contact_angle_oil_water</code></td> <td><code>0.0</code></td> <td>Oil-water contact angle (degrees)</td> </tr> <tr> <td><code>contact_angle_gas_oil</code></td> <td><code>0.0</code></td> <td>Gas-oil contact angle (degrees)</td> </tr> <tr> <td><code>j_function_coefficient</code></td> <td><code>0.5</code></td> <td>Coefficient <span class=arithmatex>\(a\)</span> in <span class=arithmatex>\(J = a \cdot S_e^{-b}\)</span></td> </tr> <tr> <td><code>j_function_exponent</code></td> <td><code>0.5</code></td> <td>Exponent <span class=arithmatex>\(b\)</span> in <span class=arithmatex>\(J = a \cdot S_e^{-b}\)</span></td> </tr> <tr> <td><code>wettability</code></td> <td><code>WATER_WET</code></td> <td>Rock wettability</td> </tr> <tr> <td><code>mixed_wet_water_fraction</code></td> <td><code>0.5</code></td> <td>Water-wet pore fraction (for <code>MIXED_WET</code>)</td> </tr> </tbody> </table> <div class="admonition warning"> <p class=admonition-title>Contact Angle Convention</p> <p>A contact angle of 0 degrees means the wetting phase perfectly wets the rock (the interface is flat against the surface). A contact angle of 90 degrees means neutral wettability. Contact angles above 90 degrees indicate the non-wetting phase is actually more wetting. In practice, petroleum engineers often specify wettability through the <code>wettability</code> parameter rather than manipulating contact angles directly.</p> </div> <hr> <h2 id=tabular-capillary-pressure>Tabular Capillary Pressure<a class=headerlink href=#tabular-capillary-pressure title="Permanent link">&para;</a></h2> <p>When you have laboratory-measured capillary pressure data from mercury injection, centrifuge, or porous plate experiments, you can use tabular capillary pressure instead of an analytical model. BORES provides <code>TwoPhaseCapillaryPressureTable</code> for single phase-pair data and <code>ThreePhaseCapillaryPressureTable</code> for combining oil-water and gas-oil data into a complete three-phase model.</p> <p>Tabular capillary pressure is the preferred approach when you have high-quality SCAL data that does not fit well to a Brooks-Corey or Van Genuchten curve. Laboratory data often shows features that analytical models cannot capture: multiple inflection points from bimodal pore size distributions, sudden changes in slope at specific saturations, or asymmetric behavior at the drainage and imbibition endpoints. Using the raw data as a table preserves all of these features.</p> <h3 id=twophasecapillarypressuretable>TwoPhaseCapillaryPressureTable<a class=headerlink href=#twophasecapillarypressuretable title="Permanent link">&para;</a></h3> <p>A <code>TwoPhaseCapillaryPressureTable</code> stores wetting phase saturation values and the corresponding capillary pressure at each saturation. You specify which fluid is the wetting phase and which is the non-wetting phase.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=kn>import</span><span class=w> </span><span class=nn>bores</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=c1># Oil-water capillary pressure from mercury injection data</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=n>ow_pc_table</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>TwoPhaseCapillaryPressureTable</span><span class=p>(</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>    <span class=n>wetting_phase</span><span class=o>=</span><span class=n>bores</span><span class=o>.</span><span class=n>FluidPhase</span><span class=o>.</span><span class=n>WATER</span><span class=p>,</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>    <span class=n>non_wetting_phase</span><span class=o>=</span><span class=n>bores</span><span class=o>.</span><span class=n>FluidPhase</span><span class=o>.</span><span class=n>OIL</span><span class=p>,</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>    <span class=n>wetting_phase_saturation</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>0.20</span><span class=p>,</span> <span class=mf>0.25</span><span class=p>,</span> <span class=mf>0.30</span><span class=p>,</span> <span class=mf>0.40</span><span class=p>,</span> <span class=mf>0.50</span><span class=p>,</span> <span class=mf>0.60</span><span class=p>,</span> <span class=mf>0.70</span><span class=p>,</span> <span class=mf>0.80</span><span class=p>]),</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>    <span class=n>capillary_pressure</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>25.0</span><span class=p>,</span> <span class=mf>12.0</span><span class=p>,</span> <span class=mf>7.5</span><span class=p>,</span> <span class=mf>4.2</span><span class=p>,</span> <span class=mf>2.8</span><span class=p>,</span> <span class=mf>1.8</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>]),</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=p>)</span>
</span></code></pre></div> <p>The <code>wetting_phase_saturation</code> array must be monotonically increasing and contain at least two points. Capillary pressure values should decrease as wetting phase saturation increases (more water means lower capillary pressure in a water-wet system). BORES uses <code>np.interp</code> for fast linear interpolation between table points, with constant extrapolation beyond the table endpoints.</p> <p>You can query the table at any saturation value or with grid arrays:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=c1># Single point query</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=n>pc_at_04</span> <span class=o>=</span> <span class=n>ow_pc_table</span><span class=o>.</span><span class=n>get_capillary_pressure</span><span class=p>(</span><span class=mf>0.4</span><span class=p>)</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=c1># Grid array query</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=n>Sw_grid</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=mf>0.2</span><span class=p>,</span> <span class=mf>0.8</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>5</span><span class=p>))</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=n>pc_grid</span> <span class=o>=</span> <span class=n>ow_pc_table</span><span class=o>.</span><span class=n>get_capillary_pressure</span><span class=p>(</span><span class=n>Sw_grid</span><span class=p>)</span>
</span></code></pre></div> <h3 id=threephasecapillarypressuretable>ThreePhaseCapillaryPressureTable<a class=headerlink href=#threephasecapillarypressuretable title="Permanent link">&para;</a></h3> <p>For three-phase simulation, combine two <code>TwoPhaseCapillaryPressureTable</code> objects into a <code>ThreePhaseCapillaryPressureTable</code>. This is the capillary pressure equivalent of the <code>ThreePhaseRelPermTable</code> and follows the same pattern.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=kn>import</span><span class=w> </span><span class=nn>bores</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=c1># Oil-water capillary pressure (water is wetting phase)</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=n>ow_pc</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>TwoPhaseCapillaryPressureTable</span><span class=p>(</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>    <span class=n>wetting_phase</span><span class=o>=</span><span class=n>bores</span><span class=o>.</span><span class=n>FluidPhase</span><span class=o>.</span><span class=n>WATER</span><span class=p>,</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>    <span class=n>non_wetting_phase</span><span class=o>=</span><span class=n>bores</span><span class=o>.</span><span class=n>FluidPhase</span><span class=o>.</span><span class=n>OIL</span><span class=p>,</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>    <span class=n>wetting_phase_saturation</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>0.20</span><span class=p>,</span> <span class=mf>0.30</span><span class=p>,</span> <span class=mf>0.40</span><span class=p>,</span> <span class=mf>0.50</span><span class=p>,</span> <span class=mf>0.60</span><span class=p>,</span> <span class=mf>0.70</span><span class=p>,</span> <span class=mf>0.80</span><span class=p>]),</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>    <span class=n>capillary_pressure</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>20.0</span><span class=p>,</span> <span class=mf>8.5</span><span class=p>,</span> <span class=mf>4.5</span><span class=p>,</span> <span class=mf>2.8</span><span class=p>,</span> <span class=mf>1.5</span><span class=p>,</span> <span class=mf>0.7</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>]),</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=p>)</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=c1># Gas-oil capillary pressure (oil is wetting phase)</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=n>go_pc</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>TwoPhaseCapillaryPressureTable</span><span class=p>(</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a>    <span class=n>wetting_phase</span><span class=o>=</span><span class=n>bores</span><span class=o>.</span><span class=n>FluidPhase</span><span class=o>.</span><span class=n>OIL</span><span class=p>,</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a>    <span class=n>non_wetting_phase</span><span class=o>=</span><span class=n>bores</span><span class=o>.</span><span class=n>FluidPhase</span><span class=o>.</span><span class=n>GAS</span><span class=p>,</span>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a>    <span class=n>wetting_phase_saturation</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>0.15</span><span class=p>,</span> <span class=mf>0.25</span><span class=p>,</span> <span class=mf>0.40</span><span class=p>,</span> <span class=mf>0.55</span><span class=p>,</span> <span class=mf>0.70</span><span class=p>,</span> <span class=mf>0.85</span><span class=p>]),</span>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a>    <span class=n>capillary_pressure</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>8.0</span><span class=p>,</span> <span class=mf>4.5</span><span class=p>,</span> <span class=mf>2.0</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mf>0.4</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>]),</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a><span class=p>)</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a>
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a><span class=c1># Combine into three-phase table</span>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a><span class=n>three_phase_pc</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>ThreePhaseCapillaryPressureTable</span><span class=p>(</span>
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a>    <span class=n>oil_water_table</span><span class=o>=</span><span class=n>ow_pc</span><span class=p>,</span>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a>    <span class=n>gas_oil_table</span><span class=o>=</span><span class=n>go_pc</span><span class=p>,</span>
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a><span class=p>)</span>
</span></code></pre></div> <p>The <code>ThreePhaseCapillaryPressureTable</code> validates the phase assignments on construction. The oil-water table must have water and oil as its phases, the gas-oil table must have oil and gas, and the gas-oil table must have oil as the wetting phase. If any of these constraints are violated, BORES raises a <code>ValidationError</code>.</p> <p>When computing capillary pressures during simulation, the three-phase table looks up <span class=arithmatex>\(P_{cow}\)</span> from the oil-water table using the wetting phase saturation and <span class=arithmatex>\(P_{cgo}\)</span> from the gas-oil table using the oil saturation. The two capillary pressures are independent (no mixing rule is needed, unlike relative permeability).</p> <div class="admonition tip"> <p class=admonition-title>When to Use Tables vs. Analytical Models</p> <p>Use tabular capillary pressure when you have high-quality laboratory SCAL data (mercury injection, centrifuge, or porous plate), when your pore size distribution is bimodal or otherwise poorly described by a single power law, or when you need to exactly reproduce measured capillary pressure curves for history matching. Use analytical models (Brooks-Corey or Van Genuchten) when lab data is unavailable, when you want to parametrically study the effect of entry pressure or pore size distribution, or when you need smooth derivatives for numerical stability.</p> </div> <hr> <h2 id=direct-usage-outside-simulation>Direct Usage (Outside Simulation)<a class=headerlink href=#direct-usage-outside-simulation title="Permanent link">&para;</a></h2> <p>You do not need to run a full simulation to evaluate capillary pressure models. All models (analytical and tabular) can be called directly with saturation values, which is useful for plotting curves, comparing models, validating against laboratory data, or building custom analysis workflows. Every model supports both scalar and grid-array inputs.</p> <h3 id=calling-analytical-models-directly>Calling Analytical Models Directly<a class=headerlink href=#calling-analytical-models-directly title="Permanent link">&para;</a></h3> <p>The <code>BrooksCoreyCapillaryPressureModel</code>, <code>VanGenuchtenCapillaryPressureModel</code>, and <code>LeverettJCapillaryPressureModel</code> all support the same calling interface. Use <code>get_capillary_pressures()</code> or <code>__call__</code> with water, oil, and gas saturations. They return a dictionary with <code>"oil_water"</code> and <code>"gas_oil"</code> keys.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=kn>import</span><span class=w> </span><span class=nn>bores</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=n>capillary</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>BrooksCoreyCapillaryPressureModel</span><span class=p>(</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>    <span class=n>irreducible_water_saturation</span><span class=o>=</span><span class=mf>0.25</span><span class=p>,</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>    <span class=n>residual_oil_saturation_water</span><span class=o>=</span><span class=mf>0.25</span><span class=p>,</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>    <span class=n>residual_oil_saturation_gas</span><span class=o>=</span><span class=mf>0.15</span><span class=p>,</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>    <span class=n>residual_gas_saturation</span><span class=o>=</span><span class=mf>0.05</span><span class=p>,</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>    <span class=n>oil_water_entry_pressure_water_wet</span><span class=o>=</span><span class=mf>5.0</span><span class=p>,</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>    <span class=n>oil_water_pore_size_distribution_index_water_wet</span><span class=o>=</span><span class=mf>2.5</span><span class=p>,</span>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>    <span class=n>gas_oil_entry_pressure</span><span class=o>=</span><span class=mf>1.5</span><span class=p>,</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>    <span class=n>gas_oil_pore_size_distribution_index</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=p>)</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=c1># Scalar evaluation</span>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=n>result</span> <span class=o>=</span> <span class=n>capillary</span><span class=o>.</span><span class=n>get_capillary_pressures</span><span class=p>(</span>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a>    <span class=n>water_saturation</span><span class=o>=</span><span class=mf>0.4</span><span class=p>,</span>
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a>    <span class=n>oil_saturation</span><span class=o>=</span><span class=mf>0.55</span><span class=p>,</span>
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a>    <span class=n>gas_saturation</span><span class=o>=</span><span class=mf>0.05</span><span class=p>,</span>
</span><span id=__span-8-20><a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a><span class=p>)</span>
</span><span id=__span-8-21><a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Pcow = </span><span class=si>{</span><span class=n>result</span><span class=p>[</span><span class=s1>&#39;oil_water&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> psi&quot;</span><span class=p>)</span>
</span><span id=__span-8-22><a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Pcgo = </span><span class=si>{</span><span class=n>result</span><span class=p>[</span><span class=s1>&#39;gas_oil&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> psi&quot;</span><span class=p>)</span>
</span><span id=__span-8-23><a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a>
</span><span id=__span-8-24><a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a><span class=c1># Using __call__ (same result)</span>
</span><span id=__span-8-25><a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a><span class=n>result</span> <span class=o>=</span> <span class=n>capillary</span><span class=p>(</span>
</span><span id=__span-8-26><a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a>    <span class=n>water_saturation</span><span class=o>=</span><span class=mf>0.4</span><span class=p>,</span>
</span><span id=__span-8-27><a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a>    <span class=n>oil_saturation</span><span class=o>=</span><span class=mf>0.55</span><span class=p>,</span>
</span><span id=__span-8-28><a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a>    <span class=n>gas_saturation</span><span class=o>=</span><span class=mf>0.05</span><span class=p>,</span>
</span><span id=__span-8-29><a id=__codelineno-8-29 name=__codelineno-8-29 href=#__codelineno-8-29></a><span class=p>)</span>
</span><span id=__span-8-30><a id=__codelineno-8-30 name=__codelineno-8-30 href=#__codelineno-8-30></a>
</span><span id=__span-8-31><a id=__codelineno-8-31 name=__codelineno-8-31 href=#__codelineno-8-31></a><span class=c1># Grid array evaluation (3D)</span>
</span><span id=__span-8-32><a id=__codelineno-8-32 name=__codelineno-8-32 href=#__codelineno-8-32></a><span class=n>Sw</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>build_uniform_grid</span><span class=p>((</span><span class=mi>20</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>5</span><span class=p>),</span> <span class=n>value</span><span class=o>=</span><span class=mf>0.4</span><span class=p>)</span>
</span><span id=__span-8-33><a id=__codelineno-8-33 name=__codelineno-8-33 href=#__codelineno-8-33></a><span class=n>So</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>build_uniform_grid</span><span class=p>((</span><span class=mi>20</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>5</span><span class=p>),</span> <span class=n>value</span><span class=o>=</span><span class=mf>0.55</span><span class=p>)</span>
</span><span id=__span-8-34><a id=__codelineno-8-34 name=__codelineno-8-34 href=#__codelineno-8-34></a><span class=n>Sg</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>build_uniform_grid</span><span class=p>((</span><span class=mi>20</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>5</span><span class=p>),</span> <span class=n>value</span><span class=o>=</span><span class=mf>0.05</span><span class=p>)</span>
</span><span id=__span-8-35><a id=__codelineno-8-35 name=__codelineno-8-35 href=#__codelineno-8-35></a>
</span><span id=__span-8-36><a id=__codelineno-8-36 name=__codelineno-8-36 href=#__codelineno-8-36></a><span class=n>result</span> <span class=o>=</span> <span class=n>capillary</span><span class=p>(</span><span class=n>water_saturation</span><span class=o>=</span><span class=n>Sw</span><span class=p>,</span> <span class=n>oil_saturation</span><span class=o>=</span><span class=n>So</span><span class=p>,</span> <span class=n>gas_saturation</span><span class=o>=</span><span class=n>Sg</span><span class=p>)</span>
</span><span id=__span-8-37><a id=__codelineno-8-37 name=__codelineno-8-37 href=#__codelineno-8-37></a><span class=n>pcow_grid</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s2>&quot;oil_water&quot;</span><span class=p>]</span>  <span class=c1># Shape: (20, 20, 5)</span>
</span><span id=__span-8-38><a id=__codelineno-8-38 name=__codelineno-8-38 href=#__codelineno-8-38></a><span class=n>pcgo_grid</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s2>&quot;gas_oil&quot;</span><span class=p>]</span>    <span class=c1># Shape: (20, 20, 5)</span>
</span></code></pre></div> <p>The <code>get_capillary_pressures()</code> method also accepts optional residual saturation overrides that take precedence over the model defaults. This is useful when the simulator passes cell-level saturation endpoints from the grid:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=n>result</span> <span class=o>=</span> <span class=n>capillary</span><span class=o>.</span><span class=n>get_capillary_pressures</span><span class=p>(</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>    <span class=n>water_saturation</span><span class=o>=</span><span class=mf>0.35</span><span class=p>,</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>    <span class=n>oil_saturation</span><span class=o>=</span><span class=mf>0.60</span><span class=p>,</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>    <span class=n>gas_saturation</span><span class=o>=</span><span class=mf>0.05</span><span class=p>,</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>    <span class=n>irreducible_water_saturation</span><span class=o>=</span><span class=mf>0.20</span><span class=p>,</span>   <span class=c1># Override model default</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>    <span class=n>residual_oil_saturation_water</span><span class=o>=</span><span class=mf>0.30</span><span class=p>,</span>  <span class=c1># Override model default</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=p>)</span>
</span></code></pre></div> <p>The Van Genuchten and Leverett J-function models use the exact same calling convention:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=n>vg</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>VanGenuchtenCapillaryPressureModel</span><span class=p>(</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>    <span class=n>irreducible_water_saturation</span><span class=o>=</span><span class=mf>0.25</span><span class=p>,</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>    <span class=n>residual_oil_saturation_water</span><span class=o>=</span><span class=mf>0.25</span><span class=p>,</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>    <span class=n>residual_oil_saturation_gas</span><span class=o>=</span><span class=mf>0.15</span><span class=p>,</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>    <span class=n>residual_gas_saturation</span><span class=o>=</span><span class=mf>0.05</span><span class=p>,</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>    <span class=n>oil_water_alpha_water_wet</span><span class=o>=</span><span class=mf>0.01</span><span class=p>,</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>    <span class=n>oil_water_n_water_wet</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>    <span class=n>gas_oil_alpha</span><span class=o>=</span><span class=mf>0.02</span><span class=p>,</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>    <span class=n>gas_oil_n</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=p>)</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a>
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a><span class=n>result</span> <span class=o>=</span> <span class=n>vg</span><span class=p>(</span><span class=n>water_saturation</span><span class=o>=</span><span class=mf>0.4</span><span class=p>,</span> <span class=n>oil_saturation</span><span class=o>=</span><span class=mf>0.55</span><span class=p>,</span> <span class=n>gas_saturation</span><span class=o>=</span><span class=mf>0.05</span><span class=p>)</span>
</span></code></pre></div> <h3 id=calling-tabular-models-directly>Calling Tabular Models Directly<a class=headerlink href=#calling-tabular-models-directly title="Permanent link">&para;</a></h3> <p>The <code>TwoPhaseCapillaryPressureTable</code> can be queried at any saturation using <code>get_capillary_pressure()</code> or <code>__call__</code>:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=c1># Using the ow_pc_table from earlier</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=n>pc_scalar</span> <span class=o>=</span> <span class=n>ow_pc_table</span><span class=o>.</span><span class=n>get_capillary_pressure</span><span class=p>(</span><span class=mf>0.45</span><span class=p>)</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Pcow at Sw=0.45: </span><span class=si>{</span><span class=n>pc_scalar</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> psi&quot;</span><span class=p>)</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=c1># Using __call__</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=n>pc_scalar</span> <span class=o>=</span> <span class=n>ow_pc_table</span><span class=p>(</span><span class=n>wetting_phase_saturation</span><span class=o>=</span><span class=mf>0.45</span><span class=p>)</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=c1># Grid array query</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=n>Sw_grid</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=mf>0.2</span><span class=p>,</span> <span class=mf>0.8</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>5</span><span class=p>))</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=n>pc_grid</span> <span class=o>=</span> <span class=n>ow_pc_table</span><span class=o>.</span><span class=n>get_capillary_pressure</span><span class=p>(</span><span class=n>Sw_grid</span><span class=p>)</span>  <span class=c1># Shape: (20, 20, 5)</span>
</span></code></pre></div> <p>The <code>ThreePhaseCapillaryPressureTable</code> uses <code>get_capillary_pressures()</code> or <code>__call__</code> with all three saturations:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=c1># Using the three_phase_pc from earlier</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=n>result</span> <span class=o>=</span> <span class=n>three_phase_pc</span><span class=o>.</span><span class=n>get_capillary_pressures</span><span class=p>(</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>    <span class=n>water_saturation</span><span class=o>=</span><span class=mf>0.4</span><span class=p>,</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>    <span class=n>oil_saturation</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a>    <span class=n>gas_saturation</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=p>)</span>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Pcow = </span><span class=si>{</span><span class=n>result</span><span class=p>[</span><span class=s1>&#39;oil_water&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> psi&quot;</span><span class=p>)</span>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Pcgo = </span><span class=si>{</span><span class=n>result</span><span class=p>[</span><span class=s1>&#39;gas_oil&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> psi&quot;</span><span class=p>)</span>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a>
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=c1># Using __call__</span>
</span><span id=__span-12-11><a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a><span class=n>result</span> <span class=o>=</span> <span class=n>three_phase_pc</span><span class=p>(</span>
</span><span id=__span-12-12><a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a>    <span class=n>water_saturation</span><span class=o>=</span><span class=n>Sw</span><span class=p>,</span>
</span><span id=__span-12-13><a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a>    <span class=n>oil_saturation</span><span class=o>=</span><span class=n>So</span><span class=p>,</span>
</span><span id=__span-12-14><a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a>    <span class=n>gas_saturation</span><span class=o>=</span><span class=n>Sg</span><span class=p>,</span>
</span><span id=__span-12-15><a id=__codelineno-12-15 name=__codelineno-12-15 href=#__codelineno-12-15></a><span class=p>)</span>
</span></code></pre></div> <p>This direct evaluation capability is essential for building capillary pressure curves for reports, comparing different models or parameter sets, and verifying that your model produces physically consistent pressures before running a simulation.</p> <hr> <h2 id=integrating-with-rockfluidtables>Integrating with RockFluidTables<a class=headerlink href=#integrating-with-rockfluidtables title="Permanent link">&para;</a></h2> <p>Capillary pressure is passed to the simulation through the <code>RockFluidTables</code> object alongside the relative permeability model. You can mix analytical and tabular approaches freely: for example, you could use Brooks-Corey relative permeability with tabular capillary pressure, or tabular relative permeability with a Van Genuchten capillary pressure model.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=kn>import</span><span class=w> </span><span class=nn>bores</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=c1># Analytical relative permeability + analytical capillary pressure</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=n>rock_fluid</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>RockFluidTables</span><span class=p>(</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>    <span class=n>relative_permeability_table</span><span class=o>=</span><span class=n>bores</span><span class=o>.</span><span class=n>BrooksCoreyThreePhaseRelPermModel</span><span class=p>(</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>        <span class=n>water_exponent</span><span class=o>=</span><span class=mf>2.5</span><span class=p>,</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>        <span class=n>oil_exponent</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>        <span class=n>gas_exponent</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>    <span class=p>),</span>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a>    <span class=n>capillary_pressure_table</span><span class=o>=</span><span class=n>bores</span><span class=o>.</span><span class=n>BrooksCoreyCapillaryPressureModel</span><span class=p>(</span>
</span><span id=__span-13-11><a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a>        <span class=n>oil_water_entry_pressure_water_wet</span><span class=o>=</span><span class=mf>5.0</span><span class=p>,</span>
</span><span id=__span-13-12><a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a>        <span class=n>oil_water_pore_size_distribution_index_water_wet</span><span class=o>=</span><span class=mf>2.5</span><span class=p>,</span>
</span><span id=__span-13-13><a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a>        <span class=n>gas_oil_entry_pressure</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span>
</span><span id=__span-13-14><a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a>        <span class=n>gas_oil_pore_size_distribution_index</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-13-15><a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a>    <span class=p>),</span>
</span><span id=__span-13-16><a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a><span class=p>)</span>
</span></code></pre></div> <p>You can also combine tabular relative permeability with an analytical capillary pressure model, or vice versa:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=c1># Tabular capillary pressure with analytical relative permeability</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=n>rock_fluid</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>RockFluidTables</span><span class=p>(</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>    <span class=n>relative_permeability_table</span><span class=o>=</span><span class=n>bores</span><span class=o>.</span><span class=n>BrooksCoreyThreePhaseRelPermModel</span><span class=p>(</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>        <span class=n>water_exponent</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>        <span class=n>oil_exponent</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>        <span class=n>gas_exponent</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>    <span class=p>),</span>
</span><span id=__span-14-8><a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a>    <span class=n>capillary_pressure_table</span><span class=o>=</span><span class=n>three_phase_pc</span><span class=p>,</span>  <span class=c1># ThreePhaseCapillaryPressureTable from lab data</span>
</span><span id=__span-14-9><a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=p>)</span>
</span></code></pre></div> <p>Pass the <code>RockFluidTables</code> to the <code>Config</code> to use it in simulation:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=n>config</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>Config</span><span class=p>(</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>    <span class=n>timer</span><span class=o>=</span><span class=n>timer</span><span class=p>,</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>    <span class=n>rock_fluid_tables</span><span class=o>=</span><span class=n>rock_fluid</span><span class=p>,</span>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>    <span class=n>wells</span><span class=o>=</span><span class=n>wells</span><span class=p>,</span>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>    <span class=n>scheme</span><span class=o>=</span><span class=s2>&quot;impes&quot;</span><span class=p>,</span>
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=p>)</span>
</span></code></pre></div> <p>Both analytical models and tabular data are serializable. When you save a <code>Config</code>, all capillary pressure parameters or table data are preserved and can be reloaded exactly.</p> <hr> <h2 id=visualizing-capillary-pressure-curves>Visualizing Capillary Pressure Curves<a class=headerlink href=#visualizing-capillary-pressure-curves title="Permanent link">&para;</a></h2> <p>Visualizing your capillary pressure curves before running a simulation is essential for verifying that the model matches your physical expectations. The best approach is to create the actual model you plan to use and call it directly across a saturation sweep. This ensures the plotted curves are exactly what the simulator will use.</p> <h3 id=oil-water-capillary-pressure>Oil-Water Capillary Pressure<a class=headerlink href=#oil-water-capillary-pressure title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=kn>import</span><span class=w> </span><span class=nn>bores</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=c1># Create the model</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=n>capillary</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>BrooksCoreyCapillaryPressureModel</span><span class=p>(</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>    <span class=n>irreducible_water_saturation</span><span class=o>=</span><span class=mf>0.25</span><span class=p>,</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>    <span class=n>residual_oil_saturation_water</span><span class=o>=</span><span class=mf>0.25</span><span class=p>,</span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>    <span class=n>residual_oil_saturation_gas</span><span class=o>=</span><span class=mf>0.15</span><span class=p>,</span>
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>    <span class=n>residual_gas_saturation</span><span class=o>=</span><span class=mf>0.05</span><span class=p>,</span>
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a>    <span class=n>oil_water_entry_pressure_water_wet</span><span class=o>=</span><span class=mf>5.0</span><span class=p>,</span>
</span><span id=__span-16-11><a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a>    <span class=n>oil_water_pore_size_distribution_index_water_wet</span><span class=o>=</span><span class=mf>2.5</span><span class=p>,</span>
</span><span id=__span-16-12><a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a>    <span class=n>gas_oil_entry_pressure</span><span class=o>=</span><span class=mf>1.5</span><span class=p>,</span>
</span><span id=__span-16-13><a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a>    <span class=n>gas_oil_pore_size_distribution_index</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-16-14><a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a><span class=p>)</span>
</span><span id=__span-16-15><a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a>
</span><span id=__span-16-16><a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a><span class=c1># Sweep water saturation across the mobile range (no free gas)</span>
</span><span id=__span-16-17><a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a><span class=n>Sw_values</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mf>0.26</span><span class=p>,</span> <span class=mf>0.75</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>  <span class=c1># Slightly above Swc to avoid singularity</span>
</span><span id=__span-16-18><a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a><span class=n>pcow_values</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>Sw_values</span><span class=p>)</span>
</span><span id=__span-16-19><a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a>
</span><span id=__span-16-20><a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>sw</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>Sw_values</span><span class=p>):</span>
</span><span id=__span-16-21><a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a>    <span class=n>so</span> <span class=o>=</span> <span class=mf>1.0</span> <span class=o>-</span> <span class=n>sw</span>  <span class=c1># No free gas</span>
</span><span id=__span-16-22><a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>capillary</span><span class=o>.</span><span class=n>get_capillary_pressures</span><span class=p>(</span>
</span><span id=__span-16-23><a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a>        <span class=n>water_saturation</span><span class=o>=</span><span class=n>sw</span><span class=p>,</span> <span class=n>oil_saturation</span><span class=o>=</span><span class=n>so</span><span class=p>,</span> <span class=n>gas_saturation</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-16-24><a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a>    <span class=p>)</span>
</span><span id=__span-16-25><a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a>    <span class=n>pcow_values</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s2>&quot;oil_water&quot;</span><span class=p>]</span>
</span><span id=__span-16-26><a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a>
</span><span id=__span-16-27><a id=__codelineno-16-27 name=__codelineno-16-27 href=#__codelineno-16-27></a><span class=n>fig</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>make_series_plot</span><span class=p>(</span>
</span><span id=__span-16-28><a id=__codelineno-16-28 name=__codelineno-16-28 href=#__codelineno-16-28></a>    <span class=n>data</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>Sw_values</span><span class=p>,</span> <span class=n>pcow_values</span><span class=p>]),</span>
</span><span id=__span-16-29><a id=__codelineno-16-29 name=__codelineno-16-29 href=#__codelineno-16-29></a>    <span class=n>title</span><span class=o>=</span><span class=s2>&quot;Brooks-Corey Oil-Water Capillary Pressure&quot;</span><span class=p>,</span>
</span><span id=__span-16-30><a id=__codelineno-16-30 name=__codelineno-16-30 href=#__codelineno-16-30></a>    <span class=n>x_label</span><span class=o>=</span><span class=s2>&quot;Water Saturation (fraction)&quot;</span><span class=p>,</span>
</span><span id=__span-16-31><a id=__codelineno-16-31 name=__codelineno-16-31 href=#__codelineno-16-31></a>    <span class=n>y_label</span><span class=o>=</span><span class=s2>&quot;Capillary Pressure (psi)&quot;</span><span class=p>,</span>
</span><span id=__span-16-32><a id=__codelineno-16-32 name=__codelineno-16-32 href=#__codelineno-16-32></a><span class=p>)</span>
</span><span id=__span-16-33><a id=__codelineno-16-33 name=__codelineno-16-33 href=#__codelineno-16-33></a><span class=n>fig</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-16-34><a id=__codelineno-16-34 name=__codelineno-16-34 href=#__codelineno-16-34></a><span class=c1># Output: [PLACEHOLDER: Insert capillary_pressure_curve.png]</span>
</span></code></pre></div> <p>This plot should show capillary pressure decreasing from a high value at low water saturation (near residual) toward zero as water saturation approaches the maximum mobile value. If the curve shows unexpected shapes (negative values in a water-wet system, or unreasonably high pressures), check your entry pressure and pore size distribution index.</p> <h3 id=comparing-models>Comparing Models<a class=headerlink href=#comparing-models title="Permanent link">&para;</a></h3> <p>You can plot multiple capillary pressure models together to compare their behavior. This is useful when deciding between Brooks-Corey and Van Genuchten, or when evaluating how different wettability settings affect the curves:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=kn>import</span><span class=w> </span><span class=nn>bores</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=c1># Brooks-Corey (water-wet)</span>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=n>bc_ww</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>BrooksCoreyCapillaryPressureModel</span><span class=p>(</span>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>    <span class=n>irreducible_water_saturation</span><span class=o>=</span><span class=mf>0.25</span><span class=p>,</span>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>    <span class=n>residual_oil_saturation_water</span><span class=o>=</span><span class=mf>0.25</span><span class=p>,</span>
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>    <span class=n>oil_water_entry_pressure_water_wet</span><span class=o>=</span><span class=mf>5.0</span><span class=p>,</span>
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a>    <span class=n>oil_water_pore_size_distribution_index_water_wet</span><span class=o>=</span><span class=mf>2.5</span><span class=p>,</span>
</span><span id=__span-17-10><a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a><span class=p>)</span>
</span><span id=__span-17-11><a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a>
</span><span id=__span-17-12><a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a><span class=c1># Van Genuchten (water-wet)</span>
</span><span id=__span-17-13><a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a><span class=n>vg_ww</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>VanGenuchtenCapillaryPressureModel</span><span class=p>(</span>
</span><span id=__span-17-14><a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a>    <span class=n>irreducible_water_saturation</span><span class=o>=</span><span class=mf>0.25</span><span class=p>,</span>
</span><span id=__span-17-15><a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a>    <span class=n>residual_oil_saturation_water</span><span class=o>=</span><span class=mf>0.25</span><span class=p>,</span>
</span><span id=__span-17-16><a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a>    <span class=n>oil_water_alpha_water_wet</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span>
</span><span id=__span-17-17><a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a>    <span class=n>oil_water_n_water_wet</span><span class=o>=</span><span class=mf>2.5</span><span class=p>,</span>
</span><span id=__span-17-18><a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a><span class=p>)</span>
</span><span id=__span-17-19><a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a>
</span><span id=__span-17-20><a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a><span class=c1># Evaluate both across the same saturation range</span>
</span><span id=__span-17-21><a id=__codelineno-17-21 name=__codelineno-17-21 href=#__codelineno-17-21></a><span class=n>Sw_range</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mf>0.26</span><span class=p>,</span> <span class=mf>0.74</span><span class=p>,</span> <span class=mi>80</span><span class=p>)</span>
</span><span id=__span-17-22><a id=__codelineno-17-22 name=__codelineno-17-22 href=#__codelineno-17-22></a><span class=n>pcow_bc</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>Sw_range</span><span class=p>)</span>
</span><span id=__span-17-23><a id=__codelineno-17-23 name=__codelineno-17-23 href=#__codelineno-17-23></a><span class=n>pcow_vg</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>Sw_range</span><span class=p>)</span>
</span><span id=__span-17-24><a id=__codelineno-17-24 name=__codelineno-17-24 href=#__codelineno-17-24></a>
</span><span id=__span-17-25><a id=__codelineno-17-25 name=__codelineno-17-25 href=#__codelineno-17-25></a><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>sw</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>Sw_range</span><span class=p>):</span>
</span><span id=__span-17-26><a id=__codelineno-17-26 name=__codelineno-17-26 href=#__codelineno-17-26></a>    <span class=n>so</span> <span class=o>=</span> <span class=mf>1.0</span> <span class=o>-</span> <span class=n>sw</span>
</span><span id=__span-17-27><a id=__codelineno-17-27 name=__codelineno-17-27 href=#__codelineno-17-27></a>    <span class=n>result_bc</span> <span class=o>=</span> <span class=n>bc_ww</span><span class=o>.</span><span class=n>get_capillary_pressures</span><span class=p>(</span>
</span><span id=__span-17-28><a id=__codelineno-17-28 name=__codelineno-17-28 href=#__codelineno-17-28></a>        <span class=n>water_saturation</span><span class=o>=</span><span class=n>sw</span><span class=p>,</span> <span class=n>oil_saturation</span><span class=o>=</span><span class=n>so</span><span class=p>,</span> <span class=n>gas_saturation</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-17-29><a id=__codelineno-17-29 name=__codelineno-17-29 href=#__codelineno-17-29></a>    <span class=p>)</span>
</span><span id=__span-17-30><a id=__codelineno-17-30 name=__codelineno-17-30 href=#__codelineno-17-30></a>    <span class=n>result_vg</span> <span class=o>=</span> <span class=n>vg_ww</span><span class=o>.</span><span class=n>get_capillary_pressures</span><span class=p>(</span>
</span><span id=__span-17-31><a id=__codelineno-17-31 name=__codelineno-17-31 href=#__codelineno-17-31></a>        <span class=n>water_saturation</span><span class=o>=</span><span class=n>sw</span><span class=p>,</span> <span class=n>oil_saturation</span><span class=o>=</span><span class=n>so</span><span class=p>,</span> <span class=n>gas_saturation</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-17-32><a id=__codelineno-17-32 name=__codelineno-17-32 href=#__codelineno-17-32></a>    <span class=p>)</span>
</span><span id=__span-17-33><a id=__codelineno-17-33 name=__codelineno-17-33 href=#__codelineno-17-33></a>    <span class=n>pcow_bc</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>result_bc</span><span class=p>[</span><span class=s2>&quot;oil_water&quot;</span><span class=p>]</span>
</span><span id=__span-17-34><a id=__codelineno-17-34 name=__codelineno-17-34 href=#__codelineno-17-34></a>    <span class=n>pcow_vg</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>result_vg</span><span class=p>[</span><span class=s2>&quot;oil_water&quot;</span><span class=p>]</span>
</span><span id=__span-17-35><a id=__codelineno-17-35 name=__codelineno-17-35 href=#__codelineno-17-35></a>
</span><span id=__span-17-36><a id=__codelineno-17-36 name=__codelineno-17-36 href=#__codelineno-17-36></a><span class=n>fig</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>make_series_plot</span><span class=p>(</span>
</span><span id=__span-17-37><a id=__codelineno-17-37 name=__codelineno-17-37 href=#__codelineno-17-37></a>    <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span><span id=__span-17-38><a id=__codelineno-17-38 name=__codelineno-17-38 href=#__codelineno-17-38></a>        <span class=s2>&quot;Brooks-Corey&quot;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>Sw_range</span><span class=p>,</span> <span class=n>pcow_bc</span><span class=p>]),</span>
</span><span id=__span-17-39><a id=__codelineno-17-39 name=__codelineno-17-39 href=#__codelineno-17-39></a>        <span class=s2>&quot;Van Genuchten&quot;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>Sw_range</span><span class=p>,</span> <span class=n>pcow_vg</span><span class=p>]),</span>
</span><span id=__span-17-40><a id=__codelineno-17-40 name=__codelineno-17-40 href=#__codelineno-17-40></a>    <span class=p>},</span>
</span><span id=__span-17-41><a id=__codelineno-17-41 name=__codelineno-17-41 href=#__codelineno-17-41></a>    <span class=n>title</span><span class=o>=</span><span class=s2>&quot;Capillary Pressure Model Comparison&quot;</span><span class=p>,</span>
</span><span id=__span-17-42><a id=__codelineno-17-42 name=__codelineno-17-42 href=#__codelineno-17-42></a>    <span class=n>x_label</span><span class=o>=</span><span class=s2>&quot;Water Saturation (fraction)&quot;</span><span class=p>,</span>
</span><span id=__span-17-43><a id=__codelineno-17-43 name=__codelineno-17-43 href=#__codelineno-17-43></a>    <span class=n>y_label</span><span class=o>=</span><span class=s2>&quot;Capillary Pressure (psi)&quot;</span><span class=p>,</span>
</span><span id=__span-17-44><a id=__codelineno-17-44 name=__codelineno-17-44 href=#__codelineno-17-44></a><span class=p>)</span>
</span><span id=__span-17-45><a id=__codelineno-17-45 name=__codelineno-17-45 href=#__codelineno-17-45></a><span class=n>fig</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-17-46><a id=__codelineno-17-46 name=__codelineno-17-46 href=#__codelineno-17-46></a><span class=c1># Output: [PLACEHOLDER: Insert capillary_pressure_comparison.png]</span>
</span></code></pre></div> <p>You should see that both models produce similar general shapes (high Pc at low Sw, low Pc at high Sw), but the Van Genuchten curve is smoother near the residual saturation where Brooks-Corey approaches infinity. This smoother behavior is why Van Genuchten is sometimes preferred for numerical stability.</p> <hr> <h2 id=choosing-a-capillary-pressure-model>Choosing a Capillary Pressure Model<a class=headerlink href=#choosing-a-capillary-pressure-model title="Permanent link">&para;</a></h2> <p>The choice of capillary pressure model depends on the data available and the simulation objectives.</p> <p><strong>Brooks-Corey</strong> is the most common starting point. It is simple, well-understood, and has only two fitting parameters per phase pair (entry pressure and pore size distribution index). Use it when you have limited data or need a quick, physically reasonable approximation. Its main limitation is the infinite capillary pressure at residual saturation, which can cause numerical issues in some cases.</p> <p><strong>Van Genuchten</strong> is preferred when numerical stability near residual saturations is important. Its smoother curve shape avoids the singularity at <span class=arithmatex>\(S_e = 0\)</span> and produces better convergence in implicit solvers. It is widely used in environmental and groundwater modeling and is increasingly common in petroleum applications. Use it when your simulation shows convergence difficulties near residual saturation with Brooks-Corey.</p> <p><strong>Leverett J-function</strong> is the best choice when you have heterogeneous rock properties and want capillary pressure to scale automatically with local porosity and permeability. If your reservoir has significant spatial variation in rock quality (e.g., layered sandstone-shale sequences), the J-function approach produces physically consistent capillary pressure distributions without needing separate models for each rock type.</p> <p><strong>Tabular data</strong> should be used when you have high-quality laboratory measurements that do not fit any analytical model well, or when you need exact reproduction of measured curves for regulatory or history-matching purposes.</p> <div class="admonition example"> <p class=admonition-title>Quick Reference: Typical Parameter Sets</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:4><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><input id=__tabbed_1_3 name=__tabbed_1 type=radio><input id=__tabbed_1_4 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>Consolidated Sandstone</label><label for=__tabbed_1_2>Tight Carbonate</label><label for=__tabbed_1_3>High-Perm Unconsolidated</label><label for=__tabbed_1_4>Heterogeneous with J-Function</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-python highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=n>capillary</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>BrooksCoreyCapillaryPressureModel</span><span class=p>(</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>    <span class=n>oil_water_entry_pressure_water_wet</span><span class=o>=</span><span class=mf>5.0</span><span class=p>,</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>    <span class=n>oil_water_pore_size_distribution_index_water_wet</span><span class=o>=</span><span class=mf>2.5</span><span class=p>,</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a>    <span class=n>gas_oil_entry_pressure</span><span class=o>=</span><span class=mf>1.5</span><span class=p>,</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a>    <span class=n>gas_oil_pore_size_distribution_index</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>    <span class=n>wettability</span><span class=o>=</span><span class=n>bores</span><span class=o>.</span><span class=n>Wettability</span><span class=o>.</span><span class=n>WATER_WET</span><span class=p>,</span>
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=p>)</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-python highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=n>capillary</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>BrooksCoreyCapillaryPressureModel</span><span class=p>(</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>    <span class=n>oil_water_entry_pressure_water_wet</span><span class=o>=</span><span class=mf>25.0</span><span class=p>,</span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>    <span class=n>oil_water_pore_size_distribution_index_water_wet</span><span class=o>=</span><span class=mf>1.2</span><span class=p>,</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a>    <span class=n>gas_oil_entry_pressure</span><span class=o>=</span><span class=mf>10.0</span><span class=p>,</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a>    <span class=n>gas_oil_pore_size_distribution_index</span><span class=o>=</span><span class=mf>1.5</span><span class=p>,</span>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>    <span class=n>wettability</span><span class=o>=</span><span class=n>bores</span><span class=o>.</span><span class=n>Wettability</span><span class=o>.</span><span class=n>OIL_WET</span><span class=p>,</span>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a>    <span class=n>oil_water_entry_pressure_oil_wet</span><span class=o>=</span><span class=mf>20.0</span><span class=p>,</span>
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a>    <span class=n>oil_water_pore_size_distribution_index_oil_wet</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span>
</span><span id=__span-19-9><a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=p>)</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-python highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=n>capillary</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>VanGenuchtenCapillaryPressureModel</span><span class=p>(</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>    <span class=n>oil_water_alpha_water_wet</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span>     <span class=c1># Low capillary pressure</span>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a>    <span class=n>oil_water_n_water_wet</span><span class=o>=</span><span class=mf>3.0</span><span class=p>,</span>          <span class=c1># Narrow pore size distribution</span>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a>    <span class=n>gas_oil_alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a>    <span class=n>gas_oil_n</span><span class=o>=</span><span class=mf>2.5</span><span class=p>,</span>
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=p>)</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-python highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=n>capillary</span> <span class=o>=</span> <span class=n>bores</span><span class=o>.</span><span class=n>LeverettJCapillaryPressureModel</span><span class=p>(</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>    <span class=n>permeability</span><span class=o>=</span><span class=mf>150.0</span><span class=p>,</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a>    <span class=n>porosity</span><span class=o>=</span><span class=mf>0.22</span><span class=p>,</span>
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a>    <span class=n>oil_water_interfacial_tension</span><span class=o>=</span><span class=mf>30.0</span><span class=p>,</span>
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a>    <span class=n>gas_oil_interfacial_tension</span><span class=o>=</span><span class=mf>20.0</span><span class=p>,</span>
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>    <span class=n>j_function_coefficient</span><span class=o>=</span><span class=mf>0.4</span><span class=p>,</span>
</span><span id=__span-21-7><a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a>    <span class=n>j_function_exponent</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span>
</span><span id=__span-21-8><a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a><span class=p>)</span>
</span></code></pre></div> </div> </div> </div> </div> <div class="admonition warning"> <p class=admonition-title>Capillary Pressure and Numerical Stability</p> <p>Very high capillary pressures (above 50 psi) can cause pressure oscillations and timestep cuts in explicit saturation schemes. If you encounter convergence problems, consider: (1) switching from Brooks-Corey to Van Genuchten for smoother behavior, (2) reducing entry pressure if the high values are not well-constrained by data, (3) using smaller timesteps in regions with high capillary gradients, or (4) using 64-bit precision via <code>bores.use_64bit_precision()</code> for better numerical accuracy.</p> </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../relative-permeability/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Relative Permeability"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Relative Permeability </div> </div> </a> <a href=../wells/basics/ class="md-footer__link md-footer__link--next" aria-label="Next: Well Basics"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Well Basics </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2025 ti-oluwa </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/ti-oluwa target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://pypi.org/project/bores-framework/ target=_blank rel=noopener title=pypi.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tabs.link", "content.tooltips", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> <script src=../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>